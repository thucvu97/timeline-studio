# Camera Capture Module

–ú–æ–¥—É–ª—å –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –≤–∏–¥–µ–æ —Å –∫–∞–º–µ—Ä—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤—ã–±–æ—Ä–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –∑–∞–ø–∏—Å–∏.

## üé• –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–í—ã–±–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤** - –í—ã–±–æ—Ä –∫–∞–º–µ—Ä—ã –∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏—è** - –ó–∞–ø—Ä–æ—Å –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ/–º–∏–∫—Ä–æ—Ñ–æ–Ω—É
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞** - –í—ã–±–æ—Ä —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏ FPS —Å —É—á–µ—Ç–æ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–ó–∞–ø–∏—Å—å –≤–∏–¥–µ–æ** - –ó–∞–ø–∏—Å—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ WebM —Å –ø—Ä–µ–≤—å—é –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **–ó–∞–ø–∏—Å—å —ç–∫—Ä–∞–Ω–∞** - –ó–∞—Ö–≤–∞—Ç —ç–∫—Ä–∞–Ω–∞, –æ–∫–Ω–∞ –∏–ª–∏ –≤–∫–ª–∞–¥–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- **UI/UX** - –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø—Ä–µ–≤—å—é –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 6 —è–∑—ã–∫–æ–≤

### ‚è≥ –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–µ–¥–∏–∞—Ç–µ–∫–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–§–∏–ª—å—Ç—Ä—ã –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã** - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –ë–∏—Ç—Ä–µ–π—Ç, –∫–æ–¥–µ–∫–∏, —Ñ–æ—Ä–º–∞—Ç—ã

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
camera-capture/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ camera-capture-modal.tsx    # –ì–ª–∞–≤–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
‚îÇ   ‚îú‚îÄ‚îÄ camera-preview.tsx          # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–µ–≤—å—é –≤–∏–¥–µ–æ
‚îÇ   ‚îú‚îÄ‚îÄ camera-settings.tsx         # –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ recording-controls.tsx      # –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å—å—é
‚îÇ   ‚îî‚îÄ‚îÄ camera-permission-request.tsx # –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ use-camera-stream.ts        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ use-devices.ts              # –†–∞–±–æ—Ç–∞ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ use-recording.ts            # –õ–æ–≥–∏–∫–∞ –∑–∞–ø–∏—Å–∏
‚îÇ   ‚îú‚îÄ‚îÄ use-screen-capture.ts       # –ó–∞–ø–∏—Å—å —ç–∫—Ä–∞–Ω–∞
‚îÇ   ‚îî‚îÄ‚îÄ camera-capture-hooks.ts     # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ö—É–∫–∏
‚îú‚îÄ‚îÄ __tests__/                      # –¢–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ index.ts                        # –≠–∫—Å–ø–æ—Ä—Ç
```

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

```tsx
import { CameraCaptureModal } from '@/features/camera-capture'

function App() {
  const [isOpen, setIsOpen] = useState(false)

  return (
    <CameraCaptureModal 
      isOpen={isOpen}
      onClose={() => setIsOpen(false)}
    />
  )
}
```

### –•—É–∫–∏

#### useDevices - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
```tsx
const {
  videoDevices,      // –°–ø–∏—Å–æ–∫ –∫–∞–º–µ—Ä
  audioDevices,      // –°–ø–∏—Å–æ–∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–≤
  selectedVideoId,   // ID –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞–º–µ—Ä—ã
  selectedAudioId,   // ID –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
  setSelectedVideoId,
  setSelectedAudioId,
  refreshDevices     // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
} = useDevices()
```

#### useCameraStream - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–æ–º
```tsx
const {
  stream,           // MediaStream
  isLoading,        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Ç–æ–∫–∞
  error,            // –û—à–∏–±–∫–∞
  startStream,      // –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ—Ç–æ–∫
  stopStream        // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Ç–æ–∫
} = useCameraStream({ 
  videoDeviceId, 
  audioDeviceId,
  constraints       // MediaStreamConstraints
})
```

#### useRecording - –ó–∞–ø–∏—Å—å –≤–∏–¥–µ–æ
```tsx
const {
  isRecording,      // –ò–¥–µ—Ç –∑–∞–ø–∏—Å—å
  isPaused,         // –ü–∞—É–∑–∞
  recordingTime,    // –í—Ä–µ–º—è –∑–∞–ø–∏—Å–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
  startRecording,   // –ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å
  stopRecording,    // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç—å Blob
  pauseRecording,   // –ü–∞—É–∑–∞
  resumeRecording   // –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
} = useRecording(mediaStream)
```

#### useScreenCapture - –ó–∞–ø–∏—Å—å —ç–∫—Ä–∞–Ω–∞
```tsx
const {
  screenStream,       // MediaStream —ç–∫—Ä–∞–Ω–∞
  isScreenSharing,    // –ò–¥–µ—Ç –∑–∞–ø–∏—Å—å —ç–∫—Ä–∞–Ω–∞
  error,              // –û—à–∏–±–∫–∞
  startScreenCapture, // –ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å —ç–∫—Ä–∞–Ω–∞
  stopScreenCapture,  // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
  getSourceInfo       // –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏—Å—Ç–æ—á–Ω–∏–∫–µ
} = useScreenCapture()
```

## üé® –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### CameraPreview
–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫ —Å –∫–∞–º–µ—Ä—ã
```tsx
<CameraPreview 
  stream={mediaStream}
  isRecording={true}
  recordingTime={45}
/>
```

### CameraSettings
–ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–∞–º–µ—Ä—ã
```tsx
<CameraSettings
  videoDevices={devices}
  audioDevices={audioDevices}
  selectedVideoId={videoId}
  selectedAudioId={audioId}
  onVideoChange={setVideoId}
  onAudioChange={setAudioId}
  capabilities={capabilities}
/>
```

### RecordingControls
–ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å—å—é
```tsx
<RecordingControls
  isRecording={isRecording}
  isPaused={isPaused}
  canStart={!!stream}
  onStart={startRecording}
  onStop={stopRecording}
  onPause={pauseRecording}
  onResume={resumeRecording}
/>
```

## üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–ú–æ–¥—É–ª—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ TopBar —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É —Å –∏–∫–æ–Ω–∫–æ–π –∫–∞–º–µ—Ä—ã:
```tsx
// src/features/top-bar/components/top-bar.tsx
<Button onClick={() => setIsCameraCaptureOpen(true)}>
  <Camera className="h-4 w-4" />
</Button>
```

## üåê –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

–í—Å–µ —Ç–µ–∫—Å—Ç—ã –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ i18n:
```json
{
  "cameraCapture": {
    "title": "–ó–∞–ø–∏—Å—å —Å –∫–∞–º–µ—Ä—ã",
    "selectCamera": "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–º–µ—Ä—É",
    "selectMicrophone": "–í—ã–±–µ—Ä–∏—Ç–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω",
    "startRecording": "–ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å",
    "stopRecording": "–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å",
    ...
  }
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: 95.39% –ø–æ–∫—Ä—ã—Ç–∏–µ
- **–•—É–∫–∏**: 72.9% –ø–æ–∫—Ä—ã—Ç–∏–µ
- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤**: 68 —Ç–µ—Å—Ç–æ–≤
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: ~1.4 —Å–µ–∫—É–Ω–¥

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –º–æ–¥—É–ª—è
bun test src/features/camera-capture

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
bun test:coverage src/features/camera-capture
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ó–∞–ø–∏—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ WebM (VP8/VP9)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã —Å MediaRecorder API
- –î–ª—è —Ä–∞–±–æ—Ç—ã —Ç—Ä–µ–±—É–µ—Ç—Å—è HTTPS –∏–ª–∏ localhost
- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏